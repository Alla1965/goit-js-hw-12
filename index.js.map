{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '48829147-1041292ac799ae9595254ba31';\n//Запит на сервер\nexport default async function searchPicture(q, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: 40,\n      },\n    });\n\n    return { hits: response.data.hits, totalHits: response.data.totalHits };\n  } catch (error) {\n    console.error('Помилка запиту:', error);\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  }\n}\n","export default function makeUpGallery(image) {\n  return `\n      ${image\n        .map(\n          ({\n            largeImageURL,\n            webformatURL,\n            tags,\n            likes,\n            views,\n            comments,\n            downloads,\n          }) => `\n      <li class=\"gallery-item photo-card\">\n          <a href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n          </a>\n          <div class=\"statistic\">\n          <div class=statistic-item-likes> \n          <p class=\"count-header\">Likes </p>\n           <p class=\"count\">${likes}</p>\n          </div>\n            <div class=statistic-item-views> \n          <p class=\"count-header\">Views </p>\n           <p class=\"count\">${views}</p>\n          </div>\n            <div class=statistic-item-comments> \n          <p class=\"count-header\">Comments </p>\n           <p class=\"count\">${comments}</p>\n          </div>\n           <div class=statistic-item-downloads> \n          <p class=\"count-header\">Downloads </p>\n           <p class=\"count\">${downloads}</p>\n          </div>\n                     </div>\n        </li>`\n        )\n        .join('')}\n  `;\n}\n","import searchPicture from './js/pixabay-api';\nimport makeUpGallery from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// створюємо об'єкт refs, який містить посилання на HTML-елементи сторінки\n\nconst refs = {\n  formEl: document.querySelector('.container'),\n  galleryContainer: document.querySelector('.gallery'),\n  loader: document.getElementById('loader'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\n// Створюємо екземпляр SimpleLightbox, який додає функціонал модального перегляду зображень у галереї\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalLoaded = 0;\nlet totalHits = 0;\n\nrefs.galleryContainer.innerHTML = '';\nrefs.loadMoreBtn.hidden = true;\n\nrefs.formEl.addEventListener('submit', async e => {\n  e.preventDefault(); //Запобігає перезавантаженню сторінки при відправці форми\n  const userValue = e.target.elements.query.value.trim(); // пошукове слово, введене користувачем\n\n  refs.galleryContainer.innerHTML = ''; //очищаємо вміст контейнера галереї перед додаванням нових зображень.\n  refs.loadMoreBtn.hidden = true;\n\n  // Перевіряємо, чи вікно вводу порожнім\n  if (!userValue || userValue.length === 0) {\n    iziToast.error({\n      title: 'Помилка',\n      message: 'Введіть запит для пошуку!',\n      position: 'topCenter',\n    });\n\n    return;\n  }\n  // Оновлюємо пошуковий запит та скидаємо сторінку\n  currentQuery = userValue;\n  currentPage = 1;\n  totalLoaded = 0;\n\n  //Показуємо індикатор завантаження (loader)\n  refs.loader.hidden = false;\n\n  //Відправляємо HTTP-запит та обробляємо відповідь\n  try {\n    const { hits, totalHits: apiTotalHits } = await searchPicture(\n      currentQuery,\n      currentPage\n    );\n    totalHits = apiTotalHits; // Оновлюємо глобальну змінну\n\n    //виводимо повідомлення  про те, що нічого не знайдено.\n    if (!hits || hits.length === 0) {\n      refs.galleryContainer.innerHTML = '';\n      iziToast.warning({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topCenter',\n      });\n      e.target.elements.query.value = '';\n      return;\n    }\n\n    renderPicture(hits, false);\n    totalLoaded = hits.length;\n\n    // Перевіряємо, чи потрібно показувати кнопку \"Load more\"\n\n    if (totalHits <= 40) {\n      refs.loadMoreBtn.hidden = true;\n    } else {\n      refs.loadMoreBtn.hidden = false;\n    }\n    //виводимо повідомлення  про помилку.\n  } catch (error) {\n    console.error('Помилка запиту:', error);\n    refs.galleryContainer.innerHTML = '';\n  } finally {\n    refs.loader.hidden = true;\n  }\n  //очищення форми після її відправлення\n  e.target.reset();\n});\n\nrefs.loadMoreBtn.addEventListener('click', async () => {\n  if (totalLoaded >= totalHits) {\n    refs.loadMoreBtn.hidden = true;\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topCenter',\n    });\n\n    return; // Зупиняємо функцію, щоб уникнути зайвого запиту!\n  }\n  currentPage += 1;\n\n  refs.loader.hidden = false;\n\n  try {\n    const { hits, totalHits } = await searchPicture(currentQuery, currentPage);\n\n    if (!hits || hits.length === 0) {\n      refs.loadMoreBtn.hidden = true;\n      return;\n    }\n    if ((currentPage - 1) * 40 >= totalHits) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topCenter',\n      });\n      refs.loadMoreBtn.hidden = true;\n      return;\n    }\n    renderPicture(hits, true);\n    totalLoaded += hits.length;\n\n    refs.loadMoreBtn.hidden = totalLoaded >= totalHits;\n    const lastImage = refs.galleryContainer.lastElementChild;\n\n    if (totalLoaded >= totalHits || hits.length < 40) {\n      refs.loadMoreBtn.hidden = true;\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topCenter',\n      });\n    } else {\n      refs.loadMoreBtn.hidden = false;\n    }\n\n    // Прокрутка до останнього зображення\n    scrollPageAfterLoad();\n\n    if (lastImage) {\n      lastImage.scrollIntoView({ behavior: 'smooth', block: 'end' });\n    }\n  } catch (error) {\n    console.error('Помилка запиту:', error);\n  } finally {\n    refs.loader.hidden = true;\n  }\n});\n\nfunction renderPicture(hits, append = true) {\n  const markup = makeUpGallery(hits);\n  if (append) {\n    refs.galleryContainer.insertAdjacentHTML('beforeend', markup);\n  } else {\n    refs.galleryContainer.innerHTML = markup;\n  }\n  lightbox.refresh();\n}\n\nfunction scrollPageAfterLoad() {\n  const firstCard = document.querySelector('.gallery .photo-card');\n  if (firstCard) {\n    const cardHeight = firstCard.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["BASE_URL","API_KEY","searchPicture","q","page","response","axios","error","makeUpGallery","image","largeImageURL","webformatURL","tags","likes","views","comments","downloads","refs","lightbox","SimpleLightbox","currentPage","currentQuery","totalLoaded","totalHits","e","userValue","iziToast","hits","apiTotalHits","renderPicture","lastImage","scrollPageAfterLoad","append","markup","firstCard","cardHeight"],"mappings":"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"}